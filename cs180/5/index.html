<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" href="styles.css" />
  <title>CS180 - Project 5</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
  </style>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>Table template</title>
  <link href="minimal-table.css" rel="stylesheet" type="text/css">
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>
</head>
<body>

<h1>Part A: The Power of Diffusion Models!</h1>

<h1>Part 1: Sampling Loops</h1>

<h2>1.1: Implementing the Forward Process</h2>
  Here are the results of applying noise to the image of the campanile.

  <br>

  <div style="text-align: center;">

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/data/campanile_processed.png" width="250" alt="Campanile">
      <figcaption>Processed Test Image, No Noise</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.1a.png" width="250" alt="Campanile">
      <figcaption>Noisy Campanile at t=250</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.1b.png" width="250" alt="Campanile">
      <figcaption>Noisy Campanile at t=500</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.1c.png" width="250" alt="Campanile">
      <figcaption>Noisy Campanile at t=750</figcaption>
    </figure>
  </div>

<h2>1.2: Classical Denoising</h2>
  Here are the results of Gaussian Denoising

  <div style="text-align: center;">
    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.1a.png" width="250" alt="Campanile">
      <figcaption>Noisy Campanile at t=250</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.1b.png" width="250" alt="Campanile">
      <figcaption>Noisy Campanile at t=500</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.1c.png" width="250" alt="Campanile">
      <figcaption>Noisy Campanile at t=750</figcaption>
    </figure>
  </div>

  <div style="text-align: center;">
    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.2a.png" width="250" alt="Campanile">
      <figcaption>Gaussian Blur Denoising at t=250</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.2b.png" width="250" alt="Campanile">
      <figcaption>Gaussian Blur Denoising at t=500</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.2c.png" width="250" alt="Campanile">
      <figcaption>Gaussian Blur Denoising at t=750</figcaption>
    </figure>
  </div>

<h2>1.3: One-Step Denoising</h2>

Here are the results of one-step denoising:

  <div style="text-align: center;">
    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.3a1.png" width="250" alt="Campanile">
      <figcaption>Noisy Campanile at t=250</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.3b1.png" width="250" alt="Campanile">
      <figcaption>Noisy Campanile at t=500</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.3c1.png" width="250" alt="Campanile">
      <figcaption>Noisy Campanile at t=750</figcaption>
    </figure>
  </div>

  <div style="text-align: center;">
    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.3a2.png" width="250" alt="Campanile">
      <figcaption>One-Step Denoised Campanile at t=250</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.3b2.png" width="250" alt="Campanile">
      <figcaption>One-Step Denoised Campanile at t=500</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.3c2.png" width="250" alt="Campanile">
      <figcaption>One-Step Denoised Campanile at t=750</figcaption>
    </figure>
  </div>

<h2>1.4: Iterative Denoising </h2>

Here are the results from Iterative Denoising. The results
from other denoising methods are also included for comparison.

  <div style="text-align: center;">
    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.4a.png" width="200" alt="Campanile">
      <figcaption>Noisy Campanile at t=690</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.4b.png" width="200" alt="Campanile">
      <figcaption>Noisy Campanile at t=540</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.4c.png" width="200" alt="Campanile">
      <figcaption>Noisy Campanile at t=390</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.4d.png" width="200" alt="Campanile">
      <figcaption>Noisy Campanile at t=240</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.4e.png" width="200" alt="Campanile">
      <figcaption>Noisy Campanile at t=90</figcaption>
    </figure>
  </div>

  <div style="text-align: center;">

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/data/campanile_processed.png" width="250" alt="Campanile">
      <figcaption>Original</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.4f.png" width="250" alt="Campanile">
      <figcaption>Iteratively Denoised Campanile</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.4g.png" width="250" alt="Campanile">
      <figcaption>One-Step Denoised Campanile</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.4h.png" width="250" alt="Campanile">
      <figcaption>Gaussian Blurred Campanile</figcaption>
    </figure>
  </div>

<h2>1.5: Diffusion Model Sampling</h2>

  Here are five image samples from using iterative denoising
  on random images.

  <div style="text-align: center;">

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.5a.png" width="200" alt="Campanile">
      <figcaption>Sample 1</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.5b.png" width="200" alt="Campanile">
      <figcaption>Sample 2</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.5c.png" width="200" alt="Campanile">
      <figcaption>Sample 3</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.5d.png" width="200" alt="Campanile">
      <figcaption>Sample 4</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.5e.png" width="200" alt="Campanile">
      <figcaption>Sample 5</figcaption>
    </figure>
  </div>

<h2>1.6: Classifier-Free Guidance (CFG)</h2>

  Here are five image samples from using iterative denoising
  with classifier-free guidance on random images.

  <div style="text-align: center;">

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.6a.png" width="200" alt="Campanile">
      <figcaption>Sample 1</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.6b.png" width="200" alt="Campanile">
      <figcaption>Sample 2</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.6c.png" width="200" alt="Campanile">
      <figcaption>Sample 3</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.6d.png" width="200" alt="Campanile">
      <figcaption>Sample 4</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.6e.png" width="200" alt="Campanile">
      <figcaption>Sample 5</figcaption>
    </figure>
  </div>

<h2>1.7: Image-to-Image Translation</h2>
  Here are the results of applying denoising with CFG to images that have
  different amounts of noise. The original image (after preprocessing) 
  is on the right for reference.

  <div style="text-align: center;">

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7a1.png" width="150" alt="Campanile">
      <figcaption>SDEdit with i_start=1</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7a2.png" width="150" alt="Campanile">
      <figcaption>SDEdit with i_start=3</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7a3.png" width="150" alt="Campanile">
      <figcaption>SDEdit with i_start=5</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7a4.png" width="150" alt="Campanile">
      <figcaption>SDEdit with i_start=7</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7a5.png" width="150" alt="Campanile">
      <figcaption>SDEdit with i_start=10</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7a6.png" width="150" alt="Campanile">
      <figcaption>SDEdit with i_start=20</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/data/campanile_processed.png" width="150" alt="Campanile">
      <figcaption>Original Image</figcaption>
    </figure>
  </div>

  <div style="text-align: center;">

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7b1.png" width="150" alt="Cat">
      <figcaption>SDEdit with i_start=1</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7b2.png" width="150" alt="Cat">
      <figcaption>SDEdit with i_start=3</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7b3.png" width="150" alt="Cat">
      <figcaption>SDEdit with i_start=5</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7b4.png" width="150" alt="Cat">
      <figcaption>SDEdit with i_start=7</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7b5.png" width="150" alt="Cat">
      <figcaption>SDEdit with i_start=10</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7b6.png" width="150" alt="Cat">
      <figcaption>SDEdit with i_start=20</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/data/cat_processed.png" width="150" alt="Cat">
      <figcaption>Original Image</figcaption>
    </figure>
  </div>

  <div style="text-align: center;">

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7c1.png" width="150" alt="Cake">
      <figcaption>SDEdit with i_start=1</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7c2.png" width="150" alt="Cake">
      <figcaption>SDEdit with i_start=3</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7c3.png" width="150" alt="Cake">
      <figcaption>SDEdit with i_start=5</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7c4.png" width="150" alt="Cake">
      <figcaption>SDEdit with i_start=7</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7c5.png" width="150" alt="Cake">
      <figcaption>SDEdit with i_start=10</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7c6.png" width="150" alt="Cake">
      <figcaption>SDEdit with i_start=20</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/data/cake_processed.png" width="150" alt="Cake">
      <figcaption>Original Image</figcaption>
    </figure>
  </div>

<h3>1.7.1: Editing Hand-Drawn and Web Images</h3>
  Here are results of the same procedure done on a web image and some drawings.
  As was the case above, the original (preprocessed) image is on the right.

  <div style="text-align: center;">

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.1a1.png" width="150" alt="Campanile">
      <figcaption>SDEdit with i_start=1</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.1a2.png" width="150" alt="Campanile">
      <figcaption>SDEdit with i_start=3</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.1a3.png" width="150" alt="Campanile">
      <figcaption>SDEdit with i_start=5</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.1a4.png" width="150" alt="Campanile">
      <figcaption>SDEdit with i_start=7</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.1a5.png" width="150" alt="Campanile">
      <figcaption>SDEdit with i_start=10</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.1a6.png" width="150" alt="Campanile">
      <figcaption>SDEdit with i_start=20</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/data/homer_processed.png" width="150" alt="Campanile">
      <figcaption>Original Image</figcaption>
    </figure>
  </div>

  <div style="text-align: center;">

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.1b1.png" width="150" alt="Cat">
      <figcaption>SDEdit with i_start=1</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.1b2.png" width="150" alt="Cat">
      <figcaption>SDEdit with i_start=3</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.1b3.png" width="150" alt="Cat">
      <figcaption>SDEdit with i_start=5</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.1b4.png" width="150" alt="Cat">
      <figcaption>SDEdit with i_start=7</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.1b5.png" width="150" alt="Cat">
      <figcaption>SDEdit with i_start=10</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.1b6.png" width="150" alt="Cat">
      <figcaption>SDEdit with i_start=20</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/data/drawing1.png" width="150" alt="Cat">
      <figcaption>Original Image</figcaption>
    </figure>
  </div>

  <div style="text-align: center;">

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.1c1.png" width="150" alt="Cake">
      <figcaption>SDEdit with i_start=1</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.1c2.png" width="150" alt="Cake">
      <figcaption>SDEdit with i_start=3</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.1c3.png" width="150" alt="Cake">
      <figcaption>SDEdit with i_start=5</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.1c4.png" width="150" alt="Cake">
      <figcaption>SDEdit with i_start=7</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.1c5.png" width="150" alt="Cake">
      <figcaption>SDEdit with i_start=10</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.1c6.png" width="150" alt="Cake">
      <figcaption>SDEdit with i_start=20</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/data/river_processed.png" width="150" alt="Cake">
      <figcaption>Original Image</figcaption>
    </figure>
  </div>

<h3>1.7.2: Inpainting</h3>

Here are results from inpainting.

  <div style="text-align: center;">

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/data/campanile_processed.png" width="250" alt="Campanile">
      <figcaption>Campanile</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.2a2.png" width="250" alt="Campanile">
      <figcaption>Mask</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.2a3.png" width="250" alt="Campanile">
      <figcaption>Hole to Fill</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.2a.png" width="250" alt="Campanile">
      <figcaption>Campanile Inpainted</figcaption>
    </figure>
  </div>

  <div style="text-align: center;">

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/data/cat_processed.png" width="250" alt="Campanile">
      <figcaption>Cat</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.2b2.png" width="250" alt="Campanile">
      <figcaption>Mask</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.2b3.png" width="250" alt="Campanile">
      <figcaption>Hole to Fill</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.2b.png" width="250" alt="Campanile">
      <figcaption>Cat Inpainted</figcaption>
    </figure>
  </div>

  <div style="text-align: center;">

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/data/cake_processed.png" width="250" alt="Campanile">
      <figcaption>Cake</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.2c2.png" width="250" alt="Campanile">
      <figcaption>Mask</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.2c3.png" width="250" alt="Campanile">
      <figcaption>Hole to Fill</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.2c.png" width="250" alt="Campanile">
      <figcaption>Cake Inpainted</figcaption>
    </figure>
  </div>

<h3>1.7.3 Text-Conditional Image-to-image Translation</h3>
Here are the results of SDEdit on the images with a guiding prompt.
The prompt for first row is "a pencil." The prompt for the second row
is "a man wearing a hat". The prompt for the third row is
"a photo of an apple".

  <div style="text-align: center;">

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.3a1.png" width="150" alt="Campanile">
      <figcaption>SDEdit with i_start=1</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.3a2.png" width="150" alt="Campanile">
      <figcaption>SDEdit with i_start=3</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.3a3.png" width="150" alt="Campanile">
      <figcaption>SDEdit with i_start=5</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.3a4.png" width="150" alt="Campanile">
      <figcaption>SDEdit with i_start=7</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.3a5.png" width="150" alt="Campanile">
      <figcaption>SDEdit with i_start=10</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.3a6.png" width="150" alt="Campanile">
      <figcaption>SDEdit with i_start=20</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/data/campanile_processed.png" width="150" alt="Campanile">
      <figcaption>Original Image</figcaption>
    </figure>
  </div>

  <div style="text-align: center;">

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.3b1.png" width="150" alt="Cat">
      <figcaption>SDEdit with i_start=1</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.3b2.png" width="150" alt="Cat">
      <figcaption>SDEdit with i_start=3</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.3b3.png" width="150" alt="Cat">
      <figcaption>SDEdit with i_start=5</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.3b4.png" width="150" alt="Cat">
      <figcaption>SDEdit with i_start=7</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.3b5.png" width="150" alt="Cat">
      <figcaption>SDEdit with i_start=10</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.3b6.png" width="150" alt="Cat">
      <figcaption>SDEdit with i_start=20</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/data/cat_processed.png" width="150" alt="Cat">
      <figcaption>Original Image</figcaption>
    </figure>
  </div>

  <div style="text-align: center;">

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.3c1.png" width="150" alt="Cake">
      <figcaption>SDEdit with i_start=1</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.3c2.png" width="150" alt="Cake">
      <figcaption>SDEdit with i_start=3</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.3c3.png" width="150" alt="Cake">
      <figcaption>SDEdit with i_start=5</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.3c4.png" width="150" alt="Cake">
      <figcaption>SDEdit with i_start=7</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.3c5.png" width="150" alt="Cake">
      <figcaption>SDEdit with i_start=10</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.7.3c6.png" width="150" alt="Cake">
      <figcaption>SDEdit with i_start=20</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/data/cake_processed.png" width="150" alt="Cake">
      <figcaption>Original Image</figcaption>
    </figure>
  </div>

<h2>1.8: Visual Anagrams</h2>

Here are two visual anagrams. The prompts are under
the corresponding images. Note that images on the same row
are related by a rotation of 180 degrees.

  <div style="text-align: center;">

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.8a1.png" width="300" alt="Cake">
      <figcaption>An Oil Painting of an Old Man</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.8a2.png" width="300" alt="Cake">
      <figcaption>An Oil Painting of people around a Campfire</figcaption>
    </figure>


  </div>

  <div style="text-align: center;">

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.8b1.png" width="300" alt="Cake">
      <figcaption>A Rocket Ship</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.8b2.png" width="300" alt="Cake">
      <figcaption>A Pencil</figcaption>
    </figure>
  </div>

<h2>1.9: Hybrid Images</h2>

Here are two hybrid images generated. For the first image, the
prompt is "a lithograph of a skull" for low frequencies and
"a lithograph of waterfalls" for high frequencies. For the second
image, the prompt is "a photo of an apple" for low frequencies
and "a photo of an orange" for high frequencies.

  <div style="text-align: center;">

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.9a.png" width="300" alt="Cake">
      <figcaption>Skull and Waterfalls</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="A/results/1.9b.png" width="300" alt="Cake">
      <figcaption>Apple and Orange</figcaption>
    </figure>
  </div>

<h1>Part B: Flow Matching from Scratch!</h1>

<h1>Part 1: Training a Single-Step Denoising UNet</h1>

<h2>1.2 Using the UNet to Train a Denoiser</h2>

Here are the results of different levels of noise on an image.
The image used is the first image from the train dataset.

  <div style="text-align: center;">

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="B/results/1.2a.png" width="150" alt="Campanile">
      <figcaption>&sigma;=0.0</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="B/results/1.2b.png" width="150" alt="Campanile">
      <figcaption>&sigma;=0.2</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="B/results/1.2c.png" width="150" alt="Campanile">
      <figcaption>&sigma;=0.4</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="B/results/1.2d.png" width="150" alt="Campanile">
      <figcaption>&sigma;=0.5</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="B/results/1.2e.png" width="150" alt="Campanile">
      <figcaption>&sigma;=0.6</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="B/results/1.2f.png" width="150" alt="Campanile">
      <figcaption>&sigma;=0.8</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="B/results/1.2g.png" width="150" alt="Campanile">
      <figcaption>&sigma;=1.0</figcaption>
    </figure>
  </div>

<h3>1.2.1 Training</h3>
The training loss from the unconditioned unet is shown below:
  <div style="text-align: center;">
    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="B/results/1.2.1plot.png" width="1000" alt="Campanile">
      <figcaption>Training Loss Over 5 Epochs</figcaption>
    </figure>
  </div>

I then used the model to denoise images from the test set. The following
are the results from denoising with the model after training for 1 epoch:

<div style="text-align: center;">
  <figure style="display: inline-block; text-align: center; margin: 0 10px;">
    <img src="B/results/1.2.1a1.png" width="300" alt="Campanile">
    <figcaption>Original Image</figcaption>
  </figure>

  <figure style="display: inline-block; text-align: center; margin: 0 10px;">
    <img src="B/results/1.2.1a2.png" width="300" alt="Campanile">
    <figcaption>&sigma;=0.5</figcaption>
  </figure>

  <figure style="display: inline-block; text-align: center; margin: 0 10px;">
    <img src="B/results/1.2.1a3.png" width="300" alt="Campanile">
    <figcaption>Denoised</figcaption>
  </figure>

  <br>

  <figure style="display: inline-block; text-align: center; margin: 0 10px;">
    <img src="B/results/1.2.1b1.png" width="300" alt="Campanile">
    <figcaption>Original Image</figcaption>
  </figure>

  <figure style="display: inline-block; text-align: center; margin: 0 10px;">
    <img src="B/results/1.2.1b2.png" width="300" alt="Campanile">
    <figcaption>&sigma;=0.5</figcaption>
  </figure>

  <figure style="display: inline-block; text-align: center; margin: 0 10px;">
    <img src="B/results/1.2.1b3.png" width="300" alt="Campanile">
    <figcaption>Denoised</figcaption>
  </figure>

  <br>

  <figure style="display: inline-block; text-align: center; margin: 0 10px;">
    <img src="B/results/1.2.1c1.png" width="300" alt="Campanile">
    <figcaption>Original Image</figcaption>
  </figure>

  <figure style="display: inline-block; text-align: center; margin: 0 10px;">
    <img src="B/results/1.2.1c2.png" width="300" alt="Campanile">
    <figcaption>&sigma;=0.5</figcaption>
  </figure>

  <figure style="display: inline-block; text-align: center; margin: 0 10px;">
    <img src="B/results/1.2.1c3.png" width="300" alt="Campanile">
    <figcaption>Denoised</figcaption>
  </figure>
</div>

The following are the results from denoising after training for 5 epochs
(these are the same input images from the test set as above):

<div style="text-align: center;">
  <figure style="display: inline-block; text-align: center; margin: 0 10px;">
    <img src="B/results/1.2.1d1.png" width="300" alt="Campanile">
    <figcaption>Original Image</figcaption>
  </figure>

  <figure style="display: inline-block; text-align: center; margin: 0 10px;">
    <img src="B/results/1.2.1d2.png" width="300" alt="Campanile">
    <figcaption>&sigma;=0.5</figcaption>
  </figure>

  <figure style="display: inline-block; text-align: center; margin: 0 10px;">
    <img src="B/results/1.2.1d3.png" width="300" alt="Campanile">
    <figcaption>Denoised</figcaption>
  </figure>

  <br>

  <figure style="display: inline-block; text-align: center; margin: 0 10px;">
    <img src="B/results/1.2.1e1.png" width="300" alt="Campanile">
    <figcaption>Original Image</figcaption>
  </figure>

  <figure style="display: inline-block; text-align: center; margin: 0 10px;">
    <img src="B/results/1.2.1e2.png" width="300" alt="Campanile">
    <figcaption>&sigma;=0.5</figcaption>
  </figure>

  <figure style="display: inline-block; text-align: center; margin: 0 10px;">
    <img src="B/results/1.2.1e3.png" width="300" alt="Campanile">
    <figcaption>Denoised</figcaption>
  </figure>

  <br>

  <figure style="display: inline-block; text-align: center; margin: 0 10px;">
    <img src="B/results/1.2.1f1.png" width="300" alt="Campanile">
    <figcaption>Original Image</figcaption>
  </figure>

  <figure style="display: inline-block; text-align: center; margin: 0 10px;">
    <img src="B/results/1.2.1f2.png" width="300" alt="Campanile">
    <figcaption>&sigma;=0.5</figcaption>
  </figure>

  <figure style="display: inline-block; text-align: center; margin: 0 10px;">
    <img src="B/results/1.2.1f3.png" width="300" alt="Campanile">
    <figcaption>Denoised</figcaption>
  </figure>
</div>

<h3>1.2.2 Out-of-Distribution Testing</h3>
For the first image of the test set, I've applied varying noise levels,
and denoised it with a model trained on noise with &sigma;=0.5.
Note the original image is the same as when &sigma;=0.0. The
results are as follows:

<div style="text-align: center;">

  <figure style="display: inline-block; text-align: center; margin: 0 10px;">
    <img src="B/results/1.2.2a1.png" width="150" alt="Campanile">
    <figcaption>&sigma;=0.0</figcaption>
  </figure>

  <figure style="display: inline-block; text-align: center; margin: 0 10px;">
    <img src="B/results/1.2.2b1.png" width="150" alt="Campanile">
    <figcaption>&sigma;=0.2</figcaption>
  </figure>

  <figure style="display: inline-block; text-align: center; margin: 0 10px;">
    <img src="B/results/1.2.2c1.png" width="150" alt="Campanile">
    <figcaption>&sigma;=0.4</figcaption>
  </figure>

  <figure style="display: inline-block; text-align: center; margin: 0 10px;">
    <img src="B/results/1.2.2d1.png" width="150" alt="Campanile">
    <figcaption>&sigma;=0.5</figcaption>
  </figure>

  <figure style="display: inline-block; text-align: center; margin: 0 10px;">
    <img src="B/results/1.2.2e1.png" width="150" alt="Campanile">
    <figcaption>&sigma;=0.6</figcaption>
  </figure>

  <figure style="display: inline-block; text-align: center; margin: 0 10px;">
    <img src="B/results/1.2.2f1.png" width="150" alt="Campanile">
    <figcaption>&sigma;=0.8</figcaption>
  </figure>

  <figure style="display: inline-block; text-align: center; margin: 0 10px;">
    <img src="B/results/1.2.2g1.png" width="150" alt="Campanile">
    <figcaption>&sigma;=1.0</figcaption>
  </figure>

  <br>

   <figure style="display: inline-block; text-align: center; margin: 0 10px;">
    <img src="B/results/1.2.2a2.png" width="150" alt="Campanile">
    <figcaption>Denoised</figcaption>
  </figure>

  <figure style="display: inline-block; text-align: center; margin: 0 10px;">
    <img src="B/results/1.2.2b2.png" width="150" alt="Campanile">
    <figcaption>Denoised</figcaption>
  </figure>

  <figure style="display: inline-block; text-align: center; margin: 0 10px;">
    <img src="B/results/1.2.2c2.png" width="150" alt="Campanile">
    <figcaption>Denoised</figcaption>
  </figure>

  <figure style="display: inline-block; text-align: center; margin: 0 10px;">
    <img src="B/results/1.2.2d2.png" width="150" alt="Campanile">
    <figcaption>Denoised</figcaption>
  </figure>

  <figure style="display: inline-block; text-align: center; margin: 0 10px;">
    <img src="B/results/1.2.2e2.png" width="150" alt="Campanile">
    <figcaption>Denoised</figcaption>
  </figure>

  <figure style="display: inline-block; text-align: center; margin: 0 10px;">
    <img src="B/results/1.2.2f2.png" width="150" alt="Campanile">
    <figcaption>Denoised</figcaption>
  </figure>

  <figure style="display: inline-block; text-align: center; margin: 0 10px;">
    <img src="B/results/1.2.2g2.png" width="150" alt="Campanile">
    <figcaption>Denoised</figcaption>
  </figure>
</div>

<h3>1.2.3 Denoising Pure Noise</h3>

Here is the training loss curve over time when training
a U-Net on pure noise:

  <div style="text-align: center;">
    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="B/results/1.2.3plot.png" width="1000" alt="Campanile">
      <figcaption>Training Loss Over 5 Epochs</figcaption>
    </figure>
  </div>

Here are examples of the model denoising pure noise after
being trained for 1 epoch:

  <div style="text-align: center;">
    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="B/results/1.2.3a1.png" width="150" alt="Campanile">
      <figcaption>Sample 1</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="B/results/1.2.3a2.png" width="150" alt="Campanile">
      <figcaption>Denoised</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="B/results/1.2.3b1.png" width="150" alt="Campanile">
      <figcaption>Sample 2</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="B/results/1.2.3b2.png" width="150" alt="Campanile">
      <figcaption>Denoised</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="B/results/1.2.3c1.png" width="150" alt="Campanile">
      <figcaption>Sample 3</figcaption>
    </figure>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="B/results/1.2.3c2.png" width="150" alt="Campanile">
      <figcaption>Denoised</figcaption>
    </figure>
  </div>

Here are examples of the model denoising pure noise after
being trained for 5 epochs:

  <div style="text-align: center;">
  <figure style="display: inline-block; text-align: center; margin: 0 10px;">
    <img src="B/results/1.2.3d1.png" width="150" alt="Campanile">
    <figcaption>Sample 1</figcaption>
  </figure>

  <figure style="display: inline-block; text-align: center; margin: 0 10px;">
    <img src="B/results/1.2.3d2.png" width="150" alt="Campanile">
    <figcaption>Denoised</figcaption>
  </figure>

  <figure style="display: inline-block; text-align: center; margin: 0 10px;">
    <img src="B/results/1.2.3e1.png" width="150" alt="Campanile">
    <figcaption>Sample 2</figcaption>
  </figure>

  <figure style="display: inline-block; text-align: center; margin: 0 10px;">
    <img src="B/results/1.2.3e2.png" width="150" alt="Campanile">
    <figcaption>Denoised</figcaption>
  </figure>

  <figure style="display: inline-block; text-align: center; margin: 0 10px;">
    <img src="B/results/1.2.3f1.png" width="150" alt="Campanile">
    <figcaption>Sample 3</figcaption>
  </figure>

  <figure style="display: inline-block; text-align: center; margin: 0 10px;">
    <img src="B/results/1.2.3f2.png" width="150" alt="Campanile">
    <figcaption>Denoised</figcaption>
  </figure>
  </div>

The generated images are similar, since the input doesn't
give any meaningful signal to the model since it is pure noise.
A pattern is that they all are white around the center and black
near the borders. This is likely close the the mean of all
images in the train set, since digits in the train set are
relatively centered. This behavior happens because the input
is not meaningful to the model, so its strategy for minimizing
L2 loss is likely to generate the population mean since the input
does not provide useful information.

<h2>Part 2: Training a Flow Matching Model</h2>
<h3>2.2 Training the UNet</h3>

Here is the training loss curve over time when training
a time-conditioned U-Net for 10 epochs. Batches are also smaller
than before, so there are more batches overall:

  <div style="text-align: center;">
    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="B/results/2.2plot.png" width="1000" alt="Campanile">
      <figcaption>Training Loss Over 10 Epochs</figcaption>
    </figure>
  </div>

<h3>2.3 Sampling from the UNet</h3>
Here are samples from the UNet after 1, 5, and 10 training epochs. 
Sampling was seeded with seed 0 for each generation, so 
corresponding samples started from the same noise:

  <div style="text-align: center;">
    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="B/results/2.3a.png" width="1000" alt="Campanile">
      <figcaption>Samples after 1 Epoch</figcaption>
    </figure>

    <br>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="B/results/2.3b.png" width="1000" alt="Campanile">
      <figcaption>Samples after 5 Epochs</figcaption>
    </figure>

    <br>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="B/results/2.3c.png" width="1000" alt="Campanile">
      <figcaption>Samples after 10 Epochs</figcaption>
    </figure>
  </div>

<h3>2.5 Training the UNet</h3>

Here is the training loss curve over time when training
a class-conditioned U-Net for 10 epochs. Batches are also smaller
than before, so there are more batches overall:

  <div style="text-align: center;">
    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="B/results/2.5plot.png" width="1000" alt="Campanile">
      <figcaption>Training Loss Over 10 Epochs</figcaption>
    </figure>
  </div>

<h3>2.6 Sampling from the UNet</h3>
Here are samples from the UNet after 1, 5, and 10 training epochs. 
Sampling was seeded with seed 0 for each generation, so 
corresponding samples started from the same noise:

  <div style="text-align: center;">
    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="B/results/2.6a1.png" width="1000" alt="Campanile">
      <figcaption>Samples after 1 Epoch</figcaption>
    </figure>

    <br>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="B/results/2.6a2.png" width="1000" alt="Campanile">
      <figcaption>Samples after 5 Epochs</figcaption>
    </figure>

    <br>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="B/results/2.6a3.png" width="1000" alt="Campanile">
      <figcaption>Samples after 10 Epochs</figcaption>
    </figure>
  </div>

After removing the scheduler, I changed the learning rate
from 1e-2 to 1e-3, since the scheduler previously decreased
the learning rate over time. The training loss over time is 
shown below:

  <div style="text-align: center;">
    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="B/results/2.6plot.png" width="1000" alt="Campanile">
      <figcaption>Training Loss Over 10 Epochs</figcaption>
    </figure>
  </div>

Samples after 1, 5, and 10 epochs from this model are
shown below:

  <div style="text-align: center;">
    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="B/results/2.6b1.png" width="1000" alt="Campanile">
      <figcaption>Samples after 1 Epoch</figcaption>
    </figure>

    <br>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="B/results/2.6b2.png" width="1000" alt="Campanile">
      <figcaption>Samples after 5 Epochs</figcaption>
    </figure>

    <br>

    <figure style="display: inline-block; text-align: center; margin: 0 10px;">
      <img src="B/results/2.6b3.png" width="1000" alt="Campanile">
      <figcaption>Samples after 10 Epochs</figcaption>
    </figure>
  </div>

</body>
</html>